<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="views/layouts/plantilla.html :: head"></head>

<body class="">

	<header th:replace="views/layouts/plantilla.html :: header"></header>

	<main class="flex justify-center items-center flex-col">
		<h1 th:text="${titulo}" class="text-3xl mb-10"></h1>
		<table id="lista" class="text-center bg-white m-auto mt-10 text-blue-600 p-5 rounded w-9/12 mb-10">
			<thead>
				<tr>
					<th>Compra</th>
					<th>Pago</th>
					<th>Monto</th>
					<th>Fecha de pago</th>
					<th></th>
					<th th:if="${rol != 'Modelador'}"></th>
					<th th:if="${rol != 'Modelador'}"></th>
				</tr>
			</thead>
			<tbody>
				<tr th:if="${compras != null}" th:each="compra: ${compras}">
					<td th:text="${compra.id}"></td>
					<td th:text="${compra.IdPago != null ? compra.IdPago : 'Pendiente'}"></td>
					<td th:text="${compra.monto}"></td>
					<td th:text="${compra.fecha} ?: 'Pendiente de pago'"></td>
					
					<td class="btn btn-secondary text-light" th:if="${rol == 'Modelador'}"><a th:href="@{/moderador/detalle/} + ${compra.id}">View</a></td>
					<td class="btn btn-secondary text-light" th:if="${rol != 'Modelador'}"><a th:href="@{/miscompras/detalle/} + ${compra.id}">View</a></td>
					<td th:if="${rol != 'Modelador'}"><a th:if="${compra.idPago == null}" th:href="@{/pago/form/} + ${compra.id} + '/' + ${compra.monto}">Pagar</a></td>
					<td th:if="${rol != 'Modelador'}"><form th:if="${compra.idPago == null}" th:action="@{/miscompras/eliminar/} + ${compra.id}" method="post" class="d-inline">
	                    <button type="submit" class="btn btn-danger bg-red-500">Eliminar</button>
	                	</form></td>
				</tr>
			</tbody>
		</table>
		<div th:if="${rol != 'Modelador'}">
			<p  th:text="${mensaje}" th:if="${mensaje}"></p>
		</div>
		<div th:if="${rol != 'Modelador'}">
			<p>Podés pagar todas tus ordenes de compra o pagarlas individualmente</p>
		</div>
		<br>
		<div th:if="${rol != 'Modelador'}">
			<a th:if="${precioTotal != 0.0}" th:href="@{/pago/form(precioTotal=${precioTotal})}" class="bg-blue-400 p-3 rounded text-white">Pagar todas</a>
		</div>
		<div th:if="${rol != 'Modelador'}">
			<a th:if="${precioTotal == 0.0}" class="bg-gray-400 p-3 rounded text-white">Todas las compras están pagas</a>
		</div>
</body>
</html>